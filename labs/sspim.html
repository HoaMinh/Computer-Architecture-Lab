<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bài thực hành JsSpim - Chi Tiết</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-blue: #00008b;
            --nav-bg: #1a237e;
            --btn-active: #5c6bc0;
            --btn-dark: #283593;
            --btn-green: #2e7d32;
            --text-dark: #333;
            --bg-light: #f0f2f5;
            --accent-blue: #e3f2fd;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
        }

        /* Header & Nav */
        .header { text-align: center; padding: 25px 0; background: white; border-bottom: 3px solid var(--primary-blue); }
        .header h1 { color: var(--primary-blue); text-transform: uppercase; margin: 0; font-size: 28px; display: flex; justify-content: center; align-items: center; gap: 12px; }
        .nav-container { background-color: var(--nav-bg); padding: 12px; display: flex; justify-content: center; gap: 12px; }
        .nav-btn { padding: 10px 20px; border-radius: 4px; text-decoration: none; color: white; font-weight: bold; display: flex; align-items: center; gap: 8px; font-size: 14px; transition: 0.2s; }
        .btn-active { background-color: var(--btn-active); }
        .btn-normal { background-color: var(--btn-dark); }
        .btn-home { background-color: var(--btn-green); }

        /* Layout */
        .content-wrapper { max-width: 1000px; margin: 30px auto; padding: 0 15px; }
        .card { background: white; border-radius: 8px; border: 1px solid var(--primary-blue); box-shadow: 0 4px 12px rgba(0,0,0,0.1); overflow: hidden; margin-bottom: 40px; }
        .card-header { background: #f8f9fa; padding: 15px 20px; border-bottom: 1px solid #eee; display: flex; align-items: center; gap: 15px; }
        .card-header i { font-size: 24px; color: var(--primary-blue); }
        .card-header h2 { margin: 0; color: var(--primary-blue); font-size: 20px; text-transform: uppercase; }
        .card-body { padding: 30px; }

        /* Section Styles */
        .section-box { margin-bottom: 25px; }
        .section-title { font-weight: bold; color: var(--primary-blue); border-bottom: 2px solid var(--accent-blue); display: inline-block; margin-bottom: 10px; }
        
        .objective-list { background: var(--accent-blue); padding: 15px 20px; border-left: 5px solid var(--btn-active); border-radius: 4px; list-style-type: square; }
        
        .instruction-steps { padding-left: 20px; }
        .instruction-steps li { margin-bottom: 8px; }

        .quiz-box { background: #fff3e0; padding: 15px 20px; border-left: 5px solid #ff9800; border-radius: 4px; margin-top: 20px; }
        .quiz-box strong { color: #e65100; }

        /* Code Block */
        .code-box { background: #272822; color: #f8f8f2; padding: 20px; border-radius: 6px; font-family: 'Consolas', monospace; margin: 15px 0; white-space: pre; overflow-x: auto; font-size: 14px; border: 1px solid #444; }
        .comment { color: #75715e; font-style: italic; }
    </style>
</head>
<body>

    <header class="header">
        <h1><i class="fas fa-microchip"></i> CHI TIẾT BÀI THỰC HÀNH JSSPIM</h1>
        <p>Hệ thống bài tập củng cố kiến trúc máy tính MIPS</p>
    </header>

    <nav class="nav-container">
        <a href="../guide/sspim.html" class="nav-btn btn-normal"><i class="fas fa-info-circle"></i> HƯỚNG DẪN</a>
        <a href="#" class="nav-btn btn-active"><i class="fas fa-tasks"></i> BÀI THỰC HÀNH</a>
        <a href="https://shawnzhong.github.io/JsSpim/" target="_blank" class="nav-btn btn-normal"><i class="fas fa-play-circle"></i> VÀO TRÌNH</a>
        <a href="../index.html" class="nav-btn btn-home"><i class="fas fa-home"></i> TRANG CHỦ</a>
    </nav>

    <div class="content-wrapper">

        <div class="card">
            <div class="card-header"><i class="fas fa-keyboard"></i><h2>BÀI 4.1 – LÀM QUEN VÀ SYSCALL CƠ BẢN</h2></div>
            <div class="card-body">
                <div class="section-box">
                    <div class="section-title">1. Mục tiêu bài học</div>
                    <ul class="objective-list">
                        <li>Làm quen với quy trình nạp và chạy mã nguồn trên JsSpim.</li>
                        <li>Sử dụng thành thạo dịch vụ hệ thống (Syscall) để giao tiếp I/O.</li>
                        <li>Phân biệt các mã dịch vụ trong $v0 (4: in chuỗi, 5: nhập số, 1: in số).</li>
                    </ul>
                </div>

                <div class="section-box">
                    <div class="section-title">2. Hướng dẫn thực hiện</div>
                    <ol class="instruction-steps">
                        <li>Truy cập trình mô phỏng JsSpim qua nút "VÀO TRÌNH".</li>
                        <li>Copy đoạn mã bên dưới và dán vào vùng soạn thảo.</li>
                        <li>Nhấn <strong>Run</strong> để chạy chương trình.</li>
                        <li>Khi vùng <strong>Output</strong> yêu cầu, hãy nhập một số nguyên và nhấn Enter.</li>
                    </ol>
                    <div class="code-box">.data
msg: .asciiz "Nhap mot so: "
.text
main:
    li $v0, 4        <span class="comment"># Chuẩn bị in chuỗi</span>
    la $a0, msg      <span class="comment"># Tải địa chỉ chuỗi msg</span>
    syscall
    li $v0, 5        <span class="comment"># Chuẩn bị nhập số nguyên</span>
    syscall
    move $t0, $v0    <span class="comment"># Lưu giá trị vừa nhập vào $t0</span>
    li $v0, 1        <span class="comment"># Chuẩn bị in số nguyên</span>
    move $a0, $t0    <span class="comment"># Đưa số cần in vào $a0</span>
    syscall
    li $v0, 10       <span class="comment"># Thoát chương trình</span>
    syscall</div>
                </div>

                <div class="quiz-box">
                    <strong><i class="fas fa-question-circle"></i> Câu hỏi ôn tập:</strong>
                    <ul>
                        <li>Tại sao phải dùng lệnh <code>move $t0, $v0</code> ngay sau khi nhập số?</li>
                        <li>Lệnh <code>la</code> (load address) khác gì so với lệnh <code>li</code> (load immediate)?</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header"><i class="fas fa-code-branch"></i><h2>BÀI 4.2 – CẤU TRÚC RẼ NHÁNH IF-ELSE</h2></div>
            <div class="card-body">
                <div class="section-box">
                    <div class="section-title">1. Mục tiêu bài học</div>
                    <ul class="objective-list">
                        <li>Hiểu cơ chế hoạt động của lệnh nhảy có điều kiện (Conditional Branch).</li>
                        <li>Biết cách sử dụng các nhãn (Labels) để điều hướng luồng chương trình.</li>
                    </ul>
                </div>

                <div class="section-box">
                    <div class="section-title">2. Hướng dẫn thực hiện</div>
                    <ol class="instruction-steps">
                        <li>Sử dụng lệnh <code>li</code> để gán giá trị cho 2 thanh ghi $t0 và $t1.</li>
                        <li>Sử dụng <code>bgt</code> (Branch if Greater Than) để so sánh.</li>
                        <li>Quan sát vùng <strong>Text Segment</strong>: dòng lệnh được tô sáng sẽ "nhảy" qua đoạn mã không thỏa mãn điều kiện.</li>
                    </ol>
                    
                    <div class="code-box">.data
msg1: .asciiz "A lon hon B"
msg2: .asciiz "A nho hon hoac bang B"
.text
main:
    li $t0, 15
    li $t1, 10
    bgt $t0, $t1, L1 <span class="comment"># Nếu t0 > t1 nhảy đến nhãn L1</span>
    li $v0, 4
    la $a0, msg2
    syscall
    j end            <span class="comment"># Nhảy không điều kiện đến cuối</span>
L1:
    li $v0, 4
    la $a0, msg1
    syscall
end:
    li $v0, 10
    syscall</div>
                </div>

                <div class="quiz-box">
                    <strong><i class="fas fa-question-circle"></i> Câu hỏi ôn tập:</strong>
                    <ul>
                        <li>Nếu không có lệnh <code>j end</code>, chuyện gì sẽ xảy ra sau khi in chuỗi msg2?</li>
                        <li>Liệt kê 3 lệnh nhảy điều kiện khác trong MIPS (Gợi ý: beq, bne, blt...).</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header"><i class="fas fa-sync"></i><h2>BÀI 4.3 – VÒNG LẶP FOR VÀ TÍNH TỔNG</h2></div>
            <div class="card-body">
                <div class="section-box">
                    <div class="section-title">1. Mục tiêu bài học</div>
                    <ul class="objective-list">
                        <li>Áp dụng lệnh nhảy để tạo vòng lặp (Loop).</li>
                        <li>Theo dõi sự thay đổi tích lũy của dữ liệu trong các thanh ghi tạm.</li>
                    </ul>
                </div>

                <div class="section-box">
                    <div class="section-title">2. Hướng dẫn thực hiện</div>
                    <ol class="instruction-steps">
                        <li>Khởi tạo biến đếm $t2 = 1 và tổng $t1 = 0.</li>
                        <li>Dùng lệnh <code>addi</code> để tăng biến đếm sau mỗi vòng lặp.</li>
                        <li>Sử dụng nút <strong>Step</strong> trên simulator để thấy giá trị $t1 tăng dần sau mỗi lần cộng.</li>
                    </ol>
                    
                    <div class="code-box">.data
n: .word 5
.text
main:
    lw $t0, n        <span class="comment"># Giới hạn N = 5</span>
    li $t1, 0        <span class="comment"># Tổng (sum)</span>
    li $t2, 1        <span class="comment"># Biến chạy (i)</span>
loop:
    add $t1, $t1, $t2
    addi $t2, $t2, 1
    ble $t2, $t0, loop <span class="comment"># Tiếp tục nếu i <= N</span>
    li $v0, 1
    move $a0, $t1
    syscall          <span class="comment"># In kết quả cuối cùng</span>
    li $v0, 10
    syscall</div>
                </div>

                <div class="quiz-box">
                    <strong><i class="fas fa-question-circle"></i> Câu hỏi ôn tập:</strong>
                    <ul>
                        <li>Thanh ghi nào đóng vai trò là "biến đếm" trong đoạn mã trên?</li>
                        <li>Làm thế nào để thay đổi chương trình tính tổng từ 1 đến 10?</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header"><i class="fas fa-layer-group"></i><h2>BÀI 4.4 – QUẢN LÝ NGĂN XẾP (STACK) VÀ GỌI HÀM</h2></div>
            <div class="card-body">
                <div class="section-box">
                    <div class="section-title">1. Mục tiêu bài học</div>
                    <ul class="objective-list">
                        <li>Hiểu nguyên lý LIFO của Stack trong tổ chức bộ nhớ.</li>
                        <li>Sử dụng lệnh <code>jal</code> (Jump and Link) và <code>jr $ra</code> (Jump Register) để quản lý chương trình con.</li>
                    </ul>
                </div>

                <div class="section-box">
                    <div class="section-title">2. Hướng dẫn thực hiện</div>
                    <ol class="instruction-steps">
                        <li>Mở vùng <strong>User Stack</strong> trên simulator để quan sát địa chỉ $sp.</li>
                        <li>Khi thực hiện <code>sw $ra, 0($sp)</code>, hãy để ý một giá trị mới được đẩy vào vùng nhớ Stack.</li>
                        <li>Kiểm tra thanh ghi <strong>$ra</strong> sau khi thực hiện lệnh <code>jal</code>.</li>
                    </ol>
                    
                    <div class="code-box">.text
main:
    li $a0, 10
    jal square       <span class="comment"># Gọi hàm tính bình phương</span>
    move $a0, $v0    <span class="comment"># Lấy kết quả trả về để in</span>
    li $v0, 1
    syscall
    li $v0, 10
    syscall

square:
    addi $sp, $sp, -4 <span class="comment"># Cấp phát 4 byte trên stack</span>
    sw $ra, 0($sp)    <span class="comment"># Cất địa chỉ trả về</span>
    mul $v0, $a0, $a0 <span class="comment"># v0 = a0 * a0</span>
    lw $ra, 0($sp)    <span class="comment"># Khôi phục địa chỉ trả về</span>
    addi $sp, $sp, 4  <span class="comment"># Giải phóng stack</span>
    jr $ra            <span class="comment"># Quay lại nơi gọi</span></div>
                </div>

                <div class="quiz-box">
                    <strong><i class="fas fa-question-circle"></i> Câu hỏi ôn tập:</strong>
                    <ul>
                        <li>Tại sao phải giảm <code>$sp</code> trước khi lưu (<code>sw</code>) và tăng <code>$sp</code> sau khi lấy ra (<code>lw</code>)?</li>
                        <li>Chuyện gì xảy ra nếu bạn quên lệnh <code>jr $ra</code> ở cuối hàm?</li>
                    </ul>
                </div>
            </div>
        </div>

    </div>
</body>
</html>
